{"version":3,"file":"static/chunks/pages/points-6f28b0bc1a8704a9.js","mappings":"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","sources":["webpack://_N_E/?e7a6","webpack://_N_E/./modules/webgl-utils.ts","webpack://_N_E/./pages/points/index.tsx","webpack://_N_E/./pages/points/shaders/points-vertex.glsl","webpack://_N_E/./pages/points/shaders/points-fragment.glsl","webpack://_N_E/./pages/points/points_page_style.module.css"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/points\",\n      function () {\n        return require(\"private-next-pages/points/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/points\"])\n      });\n    }\n  ","/** Create the WebGL program for the given context and shaders */\nfunction createProgram(\n  gl: WebGLRenderingContext,\n  vertexShader: string,\n  fragmentShader: string\n): WebGLProgram {\n  // Enable depth test and blending\n  gl.enable(gl.DEPTH_TEST);\n  gl.enable(gl.BLEND);\n  gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n  // Create vertex shader\n  const vs = gl.createShader(gl.VERTEX_SHADER)!;\n  gl.shaderSource(vs, vertexShader);\n  gl.compileShader(vs);\n\n  // Create fragment shader\n  const fs = gl.createShader(gl.FRAGMENT_SHADER)!;\n  gl.shaderSource(fs, fragmentShader);\n  gl.compileShader(fs);\n\n  // Link\n  const program = gl.createProgram()!;\n  gl.attachShader(program, fs);\n  gl.attachShader(program, vs);\n  gl.linkProgram(program);\n  gl.useProgram(program);\n\n  return program;\n}\n\n/** Create, bind, and enable a vertex attribute */\nfunction setVertexAttribute(\n  gl: WebGLRenderingContext,\n  program: WebGLProgram,\n  name: string,\n  size: number,\n  data: number[]\n): void {\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);\n\n  const location = gl.getAttribLocation(program, name);\n  gl.vertexAttribPointer(location, size, gl.FLOAT, false, 0, 0);\n  gl.enableVertexAttribArray(location);\n}\n\n/** Create and bind the indices */\nfunction setIndices(gl: WebGLRenderingContext, data: number[]): void {\n  const buffer = gl.createBuffer();\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\n  gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(data), gl.STATIC_DRAW);\n}\n\n/** Clear the WebGL context */\nfunction clear(gl: WebGLRenderingContext): void {\n  gl.clearColor(0.0, 0.0, 0.0, 0.0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n}\n\n/** Render the WebGL context on the canvas */\nfunction draw(gl: WebGLRenderingContext, canvas: HTMLCanvasElement, nIndices: number): void {\n  gl.viewport(0, 0, canvas.width, canvas.height);\n  gl.drawElements(gl.TRIANGLES, nIndices, gl.UNSIGNED_SHORT, 0);\n}\n\nexport { clear, createProgram, draw, setIndices, setVertexAttribute };\n","/* eslint-disable jsx-a11y/alt-text */\n/* eslint-disable @next/next/no-img-element */\nimport type { NextPage } from \"next\";\nimport { useEffect, useRef } from \"react\";\nimport styles from \"./points_page_style.module.css\";\nimport vertexShader from \"./shaders/points-vertex.glsl\";\nimport fragmentShader from \"./shaders/points-fragment.glsl\";\nimport { clear, createProgram, setVertexAttribute } from \"../../modules/webgl-utils\";\nimport { mat4, vec3 } from \"gl-matrix\";\n\nconst CANVAS_WIDTH = 800;\nconst CANVAS_HEIGHT = 640;\nconst NUM_POINTS = 17000000;\n\nfunction experiment(\n  canvas: HTMLCanvasElement,\n  pointsCount: number = NUM_POINTS,\n  icon = document.getElementById(\"icon\") as HTMLImageElement\n) {\n  const gl = canvas.getContext(\"webgl\");\n\n  if (!gl) return;\n\n  canvas.width = CANVAS_WIDTH;\n  canvas.height = CANVAS_HEIGHT;\n\n  const positionData: Array<number> = new Array<number>(NUM_POINTS * 3);\n  for (let pointInd = 0, dimension = 0; pointInd < NUM_POINTS; pointInd++, dimension = 0) {\n    // x\n    positionData[pointInd + dimension++] = (Math.random() - 0.5) * 8 + Math.random() * 2;\n    // y\n    positionData[pointInd + dimension++] = (Math.random() - 0.5) * 8;\n    // z\n    positionData[pointInd + dimension++] = (Math.random() - 0.5) * 8;\n  }\n\n  const program = createProgram(gl, vertexShader, fragmentShader);\n  const u_projection = gl.getUniformLocation(program, \"u_camera\");\n\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, icon);\n  gl.generateMipmap(gl.TEXTURE_2D);\n\n  setVertexAttribute(gl, program, \"a_position\", 3, positionData);\n  const pMatrix = mat4.create();\n  const vMatrix = mat4.create();\n  const ivMatrix = mat4.create();\n  const mMatrix = mat4.create();\n  const mvMatrix = mat4.create();\n  const mvpMatrix = mat4.create();\n  const position = vec3.create();\n\n  mat4.perspective(pMatrix, Math.PI * 0.35, canvas.width / canvas.height, 0.01, 100000.0);\n\n  vec3.set(position, 0.0, 0.0, 0.0);\n\n  let angle = 0.0;\n\n  // gl.clearColor(0.0, 0.0, 0.0, 0.0);\n  gl.clear(gl.COLOR_BUFFER_BIT);\n\n  gl.enable(gl.BLEND);\n  // gl.disable(gl.DEPTH_TEST);\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n  function draw() {\n    gl!.viewport(0, 0, canvas.width, canvas.height);\n    mat4.perspective(pMatrix, Math.PI * 0.35, canvas.width / canvas.height, 0.01, 1000.0);\n    angle += 0.0005;\n    // P * V * M\n    // mat4.translate(mvpMatrix, mvpMatrix, position);\n    // mat4.identity(mMatrix)\n\n    position[2] = Math.sin(performance.now() / 50000);\n\n    mat4.identity(vMatrix);\n    mat4.translate(vMatrix, vMatrix, position);\n    mat4.rotateX(vMatrix, vMatrix, angle);\n    mat4.rotateY(vMatrix, vMatrix, angle);\n    mat4.rotateZ(vMatrix, vMatrix, angle);\n\n    mat4.invert(ivMatrix, vMatrix);\n\n    mat4.multiply(mvMatrix, ivMatrix, mMatrix);\n    mat4.multiply(mvpMatrix, pMatrix, mvMatrix);\n\n    gl!.uniformMatrix4fv(u_projection, false, mvpMatrix);\n    gl!.drawArrays(gl!.POINTS, 0, pointsCount);\n    window.requestAnimationFrame(draw);\n  }\n  window.requestAnimationFrame(draw);\n}\n\nconst PointsSprite: NextPage = () => {\n  const canvas = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (canvas.current) {\n      experiment(canvas.current);\n    }\n  }, []);\n  const FORMATTED_NUM_POINTS = NUM_POINTS.toLocaleString();\n  return (\n    <div>\n      <div>\n        <h2 className={styles.title}>{FORMATTED_NUM_POINTS} Points - single draw call</h2>\n        <img\n          src=\"DATA:image/png;base64,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\"\n          hidden\n          id=\"icon\"\n        />\n        <canvas ref={canvas} className={styles.canvas} />\n      </div>\n    </div>\n  );\n};\n\nexport default PointsSprite;\n","export default \"precision highp float;\\n#define GLSLIFY 1\\nuniform mat4 u_camera;\\n\\nattribute vec3 a_position;\\n\\nvoid main(void) {\\n  gl_Position = u_camera * vec4(a_position, 1.0);\\n\\n  if (gl_Position.w > 0.0) {\\n    gl_PointSize = 4.0 / gl_Position.w;\\n  } else {\\n    gl_PointSize = 0.0;\\n  }\\n}\";","export default \"precision highp float;\\n#define GLSLIFY 1\\nuniform sampler2D u_sprite;  // texture we are drawing\\n\\nvoid main(void) {\\n  gl_FragColor = texture2D(u_sprite, gl_PointCoord);;\\n}\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"points_page_style_title__hi1jJ\",\"canvas\":\"points_page_style_canvas__1REo_\"};"],"names":["window","__NEXT_P","push","createProgram","gl","vertexShader","fragmentShader","enable","DEPTH_TEST","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","vs","createShader","VERTEX_SHADER","shaderSource","compileShader","fs","FRAGMENT_SHADER","program","attachShader","linkProgram","useProgram","setVertexAttribute","name","size","data","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","location","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","setIndices","ELEMENT_ARRAY_BUFFER","Uint16Array","clear","clearColor","COLOR_BUFFER_BIT","draw","canvas","nIndices","viewport","width","height","drawElements","TRIANGLES","UNSIGNED_SHORT","NUM_POINTS","useRef","useEffect","current","pointsCount","icon","document","getElementById","getContext","positionData","Array","pointInd","dimension","Math","random","u_projection","getUniformLocation","texture","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","pMatrix","mat4","vMatrix","ivMatrix","mMatrix","mvMatrix","mvpMatrix","position","vec3","PI","angle","SRC_ALPHA","requestAnimationFrame","sin","performance","now","uniformMatrix4fv","drawArrays","POINTS","experiment","FORMATTED_NUM_POINTS","toLocaleString","div","h2","className","styles","img","src","hidden","id","ref","module","exports"],"sourceRoot":""}